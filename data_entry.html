<!DOCTYPE html>
<html lang="am">
<head>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-2XX2B3RSGP"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-2XX2B3RSGP');
  </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>áˆ˜áˆ¨áŒƒ áˆ›áˆµáŒˆá‰¢á‹« - á‰£áŒƒáŒ… áˆ˜áˆ¨áŒƒ</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Noto+Sans+Ethiopic:wght@400;700&display=swap" rel="stylesheet">
     <script>
        // áŒˆáŒ¹ áˆ²áŒ«áŠ• á‹ˆá‹²á‹«á‹áŠ‘ á‹¨áˆ˜áŒá‰¢á‹« áˆáŠ”á‰³áŠ• áŠ áˆ¨áŒ‹áŒáŒ¥
        if (localStorage.getItem('isLoggedIn') !== 'true') {
            alert("áˆˆáˆ˜áŒá‰£á‰µ áá‰ƒá‹µ á‹¨áˆˆá‹á‰µáˆá¢ áŠ¥á‰£áŠ­á‹ áŠ¥áŠ•á‹°áŒˆáŠ“ á‹­áŒá‰¡á¢");
            window.location.href = 'login.html';
        }
    </script>
    
    <script type="module">
        // Firebase SDKs and config for data_entry.html
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-analytics.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyA-ywRuhanxoEJgR83jwp_-nOkPY4jLOH4",
          authDomain: "elanyas-info.firebaseapp.com",
          projectId: "elanyas-info",
          storageBucket: "elanyas-info.firebasestorage.app",
          messagingSenderId: "769306910360",
          appId: "1:769306910360:web:70988eed5b1da8ffa0faed",
          measurementId: "G-2XX2B3RSGP"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app); // For Cloud Firestore
        const analytics = getAnalytics(app); // For Firebase Analytics

        // Expose db and analytics globally (optional, but helpful for quick testing in console)
        window.db = db;
        window.analytics = analytics;
        window.collection = collection; // Expose collection and addDoc as well for easier use
        window.addDoc = addDoc;
        window.serverTimestamp = serverTimestamp; // Expose serverTimestamp

        console.log("Firebase initialized and Firestore DB instance available for data_entry.html."); // áˆˆáˆ˜áˆá‰°áˆ½

    </script>
</head>
<body>
    <header class="main-header">
      <div class="ad-marquee-container">
        <p class="ad-marquee-text">
            âœ¨ áŠ á‹²áˆµ á‰£áŒƒáŒ… áˆá‹´áˆá‰½ á‰ á‰…áˆ­á‰¡ á‹­áˆ˜áŒ£áˆ‰! &nbsp; &nbsp; &nbsp; &nbsp;
            ğŸ’¡ áˆˆá‰µáˆ«áŠ•áˆµá–áˆ­á‰µ áŠ áŒˆáˆáŒáˆá‰µ á‰£áŒƒáŒ… á‹­áˆáˆáŒ‹áˆ‰? &nbsp; &nbsp; &nbsp; &nbsp;
            ğŸ’° á‹¨áŠá‹³áŒ… á‰…áŠ“áˆ½ áˆ˜áˆ¨áŒƒ á‰ á‰…áˆ­á‰¡ á‹­á‹ á‹­áˆ†áŠ“áˆ! &nbsp; &nbsp; &nbsp; &nbsp;
            ğŸ› ï¸ áŠ á‹²áˆµ á‹¨áŒ¥áŒˆáŠ“ áˆáŠ­áˆ®á‰½áŠ• á‹­áˆ˜áˆáŠ¨á‰±! &nbsp; &nbsp; &nbsp; &nbsp;
        </p>
      </div>
        <h1><span class="accent-text">áˆ˜áˆ¨áŒƒ</span> áˆ›áˆµáŒˆá‰¢á‹«</h1>
        <p>á‹¨áŠá‹³áŒ… áŒ¥á‰†áˆ›á£ á‹¨áˆ›á‹°á‹« á‹ˆá‹­áˆ á‹¨áˆ›áˆ…á‰ áˆ¨áˆ°á‰¥ áˆ˜áˆ¨áŒƒ á‹«áˆµáŒˆá‰¡</p>
        <nav class="sub-nav">
            <a href="data.html">á‹‹áŠ“á‹ áŒˆáŒ½</a>
            <a href="news.html">á‹œáŠ“á‹á‰½</a>
            <a href="sales.html">áˆ˜áˆ¸áŒ«</a>
            <a href="maintenance.html">áŠ¥áŠ•áŠ­á‰¥áŠ«á‰¤</a>
            <a href="community_data.html">áˆá‹á‹áŒ¥</a> </nav>
    </header>

    <main class="container">
        <section class="data-entry-selection-card">
            <h2>á‹¨áˆ˜áˆ¨áŒƒ áŠ á‹­áŠá‰µ á‹­áˆáˆ¨áŒ¡</h2>
            <div class="selection-options">
                <input type="radio" id="tipOffOption" name="dataType" value="tipOff" checked>
                <label for="tipOffOption">áŒ¥á‰áˆ­ áŒˆá‰ á‹« áŒ¥á‰†áˆ› (áˆˆá‰°á‰†áŒ£áŒ£áˆªá‹ á‰¥á‰»)</label><br>

                <input type="radio" id="stationInfoOption" name="dataType" value="stationInfo">
                <label for="stationInfoOption">á‹¨áˆ›á‹°á‹« áˆ˜áˆ¨áŒƒ áˆ›áˆµáŒˆá‰¢á‹« (áˆˆáˆáˆ‰áˆ á‹­á‰³á‹«áˆ)</label><br>

                <input type="radio" id="communityPostOption" name="dataType" value="communityPost">
                <label for="communityPostOption">á‹¨áˆ›áˆ…á‰ áˆ¨áˆ°á‰¥ áˆáŒ¥á (áˆˆáˆáˆ‰áˆ á‹­á‰³á‹«áˆ)</label>
            </div>
        </section>

        <section id="tipOffFormSection" class="data-entry-form-card">
            <h2>áŒ¥á‰áˆ­ áŒˆá‰ á‹« áŒ¥á‰†áˆ›</h2>
            <form id="tipOffForm" class="data-form">
                <label for="tipOffLocation">á‹¨áˆ½á‹«áŒ© á‰¦á‰³ áˆ˜áŒáˆˆáŒ«/áŠ á‹µáˆ«áˆ»:</label>
                <textarea id="tipOffLocation" name="location" rows="4" required placeholder="áˆˆáˆáˆ³áˆŒ: á‰ƒáˆŠá‰² áŠ á‹°á‰£á‰£á‹­ áŠ áŠ«á‰£á‰¢ áŠ«áˆˆá‹ á‹µáˆá‹µá‹­ áˆµáˆ­"></textarea>

                <label for="tipOffDetails">á‰°áŒ¨áˆ›áˆª á‹áˆ­á‹áˆ®á‰½:</label>
                <textarea id="tipOffDetails" name="details" rows="3" placeholder="áˆˆáˆáˆ³áˆŒ: á‹¨áˆ˜áŠªáŠ“ áŠ á‹­áŠá‰µá£ á‹¨áˆ»áŒ© áˆ˜áŒáˆˆáŒ«á£ á‹¨á‹‹áŒ‹ áŒáˆá‰µ"></textarea>
                
                <button type="submit" class="submit-button">áŒ¥á‰†áˆ› áŠ áˆµáŒˆá‰£</button>
                <p id="tipOffMessage" class="form-message"></p>
            </form>
        </section>

        <section id="stationInfoFormSection" class="data-entry-form-card" style="display: none;">
            <h2>á‹¨áˆ›á‹°á‹« áˆ˜áˆ¨áŒƒ áˆ›áˆµáŒˆá‰¢á‹«</h2>
            <form id="stationInfoForm" class="data-form">
                <label for="stationName">á‹¨áˆ›á‹°á‹«á‹ áˆµáˆ:</label>
                <input type="text" id="stationName" name="stationName" required placeholder="áˆˆáˆáˆ³áˆŒ: á‰¶á‰³áˆ áŒ‹áˆ«á‹¥">

                <label for="fuelType">á‹¨áŠá‹³áŒ… áŠ á‹­áŠá‰µ:</label>
                <select id="fuelType" name="fuelType" required>
                    <option value="">á‹­áˆáˆ¨áŒ¡</option>
                    <option value="á‰¤áŠ•á‹šáŠ•">á‰¤áŠ•á‹šáŠ•</option>
                    <option value="áŠ“ááŒ£">áŠ“ááŒ£</option>
                    <option value="áŒ‹á‹">áŒ‹á‹</option>
                </select>

                <label for="fuelStatus">á‹¨áŠá‹³áŒ… áˆáŠ”á‰³:</label>
                <select id="fuelStatus" name="fuelStatus" required>
                    <option value="">á‹­áˆáˆ¨áŒ¡</option>
                    <option value="áŠ áˆˆ">áŠ áˆˆ</option>
                    <option value="áŠ áŠáˆµá‰°áŠ›">áŠ áŠáˆµá‰°áŠ›</option>
                    <option value="á‹¨áˆˆáˆ">á‹¨áˆˆáˆ</option>
                </select>

                <label for="queueStatus">á‹¨á‹ˆáˆ¨á‹ áˆáŠ”á‰³:</label>
                <select id="queueStatus" name="queueStatus" required>
                    <option value="">á‹­áˆáˆ¨áŒ¡</option>
                    <option value="á‹¨áˆˆáˆ">á‹¨áˆˆáˆ</option>
                    <option value="áŠ áŒ­áˆ­">áŠ áŒ­áˆ­</option>
                    <option value="áˆ˜áŠ«áŠ¨áˆˆáŠ›">áˆ˜áŠ«áŠ¨áˆˆáŠ›</option>
                    <option value="áˆ¨áŒ…áˆ">áˆ¨áŒ…áˆ</option>
                </select>
                
                <button type="submit" class="submit-button">áˆ˜áˆ¨áŒƒ áŠ áˆµáŒˆá‰£</button>
                <p id="stationInfoMessage" class="form-message"></p>
            </form>
        </section>

        <section id="communityPostEntryFormSection" class="data-entry-form-card" style="display: none;">
            <h2>á‹¨áˆ›áˆ…á‰ áˆ¨áˆ°á‰¥ áˆáŒ¥á á‹­ááŒ áˆ©</h2>
            <form id="communityPostForm" class="data-form">
                <label for="postTitle">áˆ­á‹•áˆµ:</label>
                <input type="text" id="postTitle" name="postTitle" required placeholder="á‹¨áˆáŒ¥á‰áŠ• áˆ­á‹•áˆµ á‹«áˆµáŒˆá‰¡">

                <label for="postContent">áŒ½áˆ‘á:</label>
                <textarea id="postContent" name="postContent" rows="8" required placeholder="áˆáŒ¥áá‹áŠ• áŠ¥á‹šáˆ… á‹­áŒ»á‰..."></textarea>
                
                <button type="submit" class="submit-button">áˆáŒ¥á áŠ áˆµáŒˆá‰£</button>
                <p id="communityPostMessage" class="form-message"></p>
            </form>
        </section>
    </main>

    <footer class="main-footer">
        <p>&copy; 2025 á‹¨á‰£áŒƒáŒ… áˆ˜áˆ¨áŒƒ áˆ›á‹•áŠ¨áˆ. áˆáˆ‰áˆ áˆ˜á‰¥á‰¶á‰½ á‹¨á‰°áŒ á‰ á‰ áŠ“á‰¸á‹á¢</p>
        <p>áˆˆá‹ˆá‰…á‰³á‹Š áˆ˜áˆ¨áŒƒ á‹µáˆ¨-áŒˆáŒ»á‰½áŠ•áŠ• á‹­áŒá‰¥áŠ™á¢</p>
    </footer>

    <script type="module">
        // Firebase modules are already imported at the top of the head section via type="module"
        // and 'app', 'db', 'analytics', 'collection', 'addDoc', 'serverTimestamp' are globally exposed.

        document.addEventListener('DOMContentLoaded', function() {
            // Form Selection Logic
            const tipOffOption = document.getElementById('tipOffOption');
            const stationInfoOption = document.getElementById('stationInfoOption');
            const communityPostOption = document.getElementById('communityPostOption');

            const tipOffFormSection = document.getElementById('tipOffFormSection');
            const stationInfoFormSection = document.getElementById('stationInfoFormSection');
            const communityPostEntryFormSection = document.getElementById('communityPostEntryFormSection');

            function toggleForms() {
                if (tipOffOption.checked) {
                    tipOffFormSection.style.display = 'block';
                    stationInfoFormSection.style.display = 'none';
                    communityPostEntryFormSection.style.display = 'none';
                } else if (stationInfoOption.checked) {
                    tipOffFormSection.style.display = 'none';
                    stationInfoFormSection.style.display = 'block';
                    communityPostEntryFormSection.style.display = 'none';
                } else if (communityPostOption.checked) {
                    tipOffFormSection.style.display = 'none';
                    stationInfoFormSection.style.display = 'none';
                    communityPostEntryFormSection.style.display = 'block';
                }
            }

            // Initial form display on page load
            toggleForms();

            // Event listeners for radio button changes
            tipOffOption.addEventListener('change', toggleForms);
            stationInfoOption.addEventListener('change', toggleForms);
            communityPostOption.addEventListener('change', toggleForms);
            
            // --- Form Submission Logic ---

            // 1. Tip-Off Form Submission (áŒ¥á‰áˆ­ áŒˆá‰ á‹« áŒ¥á‰†áˆ›)
            const tipOffForm = document.getElementById('tipOffForm');
            const tipOffMessage = document.getElementById('tipOffMessage');

            tipOffForm.addEventListener('submit', async function(e) {
                e.preventDefault(); // Prevent default form submission

                tipOffMessage.textContent = 'áˆ˜áˆ¨áŒƒ á‰ áˆ˜áˆ‹áŠ­ áˆ‹á‹­...';
                tipOffMessage.style.color = '#e0e0e0';

                const location = tipOffForm.tipOffLocation.value;
                const details = tipOffForm.tipOffDetails.value;
                
                try {
                    // Using addDoc and collection for Firestore (ESM syntax)
                    await window.addDoc(window.collection(window.db, "tipOffs"), {
                        location: location,
                        details: details,
                        timestamp: window.serverTimestamp() // Firestore's server-side timestamp
                    });

                    tipOffForm.reset(); // Clear form fields
                    tipOffMessage.textContent = 'áŒ¥á‰†áˆ›á‹ á‰ á‰°áˆ³áŠ« áˆáŠ”á‰³ á‰°áˆáŠ³áˆ! áŠ¥áŠ“áˆ˜áˆ°áŒáŠ“áˆˆáŠ•á¢';
                    tipOffMessage.style.color = '#4CAF50'; // Green for success

                } catch (error) {
                    console.error("Error adding tip-off document: ", error);
                    tipOffMessage.textContent = 'áŒ¥á‰†áˆ›á‹áŠ• á‰ áˆ˜áˆ‹áŠ­ áˆ‹á‹­ áˆµáˆ…á‰°á‰µ á‰°áˆáŒ¥áˆ¯áˆ: ' + error.message;
                    tipOffMessage.style.color = '#f44336'; // Red for error
                }
            });

            // 2. Station Info Form Submission (á‹¨áˆ›á‹°á‹« áˆ˜áˆ¨áŒƒ áˆ›áˆµáŒˆá‰¢á‹«)
            const stationInfoForm = document.getElementById('stationInfoForm');
            const stationInfoMessage = document.getElementById('stationInfoMessage');

            stationInfoForm.addEventListener('submit', async function(e) {
                e.preventDefault(); // Prevent default form submission

                stationInfoMessage.textContent = 'áˆ˜áˆ¨áŒƒ á‰ áˆ˜áˆ‹áŠ­ áˆ‹á‹­...';
                stationInfoMessage.style.color = '#e0e0e0';

                const stationName = stationInfoForm.stationName.value;
                const fuelType = stationInfoForm.fuelType.value;
                const fuelStatus = stationInfoForm.fuelStatus.value;
                const queueStatus = stationInfoForm.queueStatus.value;

                try {
                    await window.addDoc(window.collection(window.db, "fuelStations"), {
                        stationName: stationName,
                        fuelType: fuelType,
                        fuelStatus: fuelStatus,
                        queueStatus: queueStatus,
                        timestamp: window.serverTimestamp() // Firestore's server-side timestamp
                    });

                    stationInfoForm.reset(); // Clear form fields
                    stationInfoMessage.textContent = 'á‹¨áˆ›á‹°á‹« áˆ˜áˆ¨áŒƒá‹ á‰ á‰°áˆ³áŠ« áˆáŠ”á‰³ á‰°áˆáŠ³áˆ!';
                    stationInfoMessage.style.color = '#4CAF50'; // Green for success

                } catch (error) {
                    console.error("Error adding station info document: ", error);
                    stationInfoMessage.textContent = 'á‹¨áˆ›á‹°á‹« áˆ˜áˆ¨áŒƒá‹áŠ• á‰ áˆ˜áˆ‹áŠ­ áˆ‹á‹­ áˆµáˆ…á‰°á‰µ á‰°áˆáŒ¥áˆ¯áˆ: ' + error.message;
                    stationInfoMessage.style.color = '#f44336'; // Red for error
                }
            });

            // 3. Community Post Form Submission (á‹¨áˆ›áˆ…á‰ áˆ¨áˆ°á‰¥ áˆáŒ¥á)
            const communityPostForm = document.getElementById('communityPostForm');
            const communityPostMessage = document.getElementById('communityPostMessage');

            communityPostForm.addEventListener('submit', async function(e) {
                e.preventDefault(); // Prevent default form submission

                communityPostMessage.textContent = 'áˆáŒ¥á á‰ áˆ˜áˆ‹áŠ­ áˆ‹á‹­...';
                communityPostMessage.style.color = '#e0e0e0';

                const postTitle = communityPostForm.postTitle.value;
                const postContent = communityPostForm.postContent.value;
                // á‰ áŠ¢á‰µá‹®áŒµá‹« áˆµáˆ‹áˆˆáŠ• áŠ¥áŠ“ á‰°áŒ á‰ƒáˆšá‹ áŒˆá‰¥á‰¶ (Login) áˆµáˆ‹áˆáˆ†áŠ 'Unknown User' á‹ˆá‹­áˆ 'Guest' áŠ¥áŠ•á‰ áˆˆá‹
                // á‹ˆá‹°áŠá‰µ á‹¨áˆ˜áŒá‰¢á‹« áˆ²áˆµá‰°áˆ áˆµáŠ•áˆ°áˆ« á‰°áŒ á‰ƒáˆšá‹áŠ• áŠ¨Auth áŠ¥áŠ“áŒˆáŠ“áŠ˜á‹‹áˆˆáŠ•
                const author = "Guest"; // áˆˆáŒŠá‹œá‹ 'Guest' áŠ¥áŠ•áŒ á‰€áˆ

                try {
                    await window.addDoc(window.collection(window.db, "communityPosts"), {
                        title: postTitle,
                        content: postContent,
                        author: author,
                        timestamp: window.serverTimestamp() // Firestore's server-side timestamp
                    });

                    communityPostForm.reset(); // Clear form fields
                    communityPostMessage.textContent = 'áˆáŒ¥áá‹ á‰ á‰°áˆ³áŠ« áˆáŠ”á‰³ á‰³á‰µáˆŸáˆ!';
                    communityPostMessage.style.color = '#4CAF50'; // Green for success

                } catch (error) {
                    console.error("Error adding community post document: ", error);
                    communityPostMessage.textContent = 'áˆáŒ¥á‰áŠ• á‰ áˆ˜áˆ‹áŠ­ áˆ‹á‹­ áˆµáˆ…á‰°á‰µ á‰°áˆáŒ¥áˆ¯áˆ: ' + error.message;
                    communityPostMessage.style.color = '#f44336'; // Red for error
                }
            });

            console.log("All form submission listeners are set up.");
        });
    </script>
</body>
</html>